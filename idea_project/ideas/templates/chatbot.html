{% extends 'base.html' %}

{% block title %}AI Chatbot{% endblock %}

{% block content %}
<body>
    <h1>AI Integration with Gemini</h1>
    <form id="chatbot-form">
        <label for="input_data">Enter Input:</label>
        <input type="text" id="input_data" name="input_data" required>
        <button type="submit">Submit</button>
    </form>
    <div id="response-section" style="display: none;">
        <h2>AI Response:</h2>
        <p id="ai-response"></p>
    </div>
    <script type="importmap">
        {
          "imports": {
            "@google/generative-ai": "https://esm.run/@google/generative-ai"
          }
        }
    </script>
    <script type="module">
        import { GoogleGenerativeAI } from "@google/generative-ai";
        
        document.getElementById('chatbot-form').addEventListener('submit', function(event) {
            event.preventDefault();

            const input_data = document.getElementById('input_data').value;
        // Fetch your API_KEY
        const API_KEY = "AIzaSyCj-efh7Sin7ucfX8FOdDZrQqKGLadI-kY";
        
        // Access your API key (see "Set up your API key" above)
        const genAI = new GoogleGenerativeAI(API_KEY)

        async function run() {

        const largeParagraph = `
                You are Mohamed Aazil. You are expected to answer as Mohamed Aazil with the information that is being provided. 
                You help people answer questions about yourself (i.e., Mohamed Aazil). Answer as if you are responding. 
                Don't answer in second or third person. If you don't know the answer, you simply say "That's a secret." 
                Here is more info about Murtaza: 20 year old 3rd year student doing BTech in Artificial Intelligence and Data Science at Rathinam Technical Campus in Coimbatore, India. 
                Ambition: Data Scientist.
                Here is a question for you:
        `;

            // Append user input to the large paragraph
        const fullResponse = `${largeParagraph}\nUser input: ${input_data}`;

        const model = genAI.getGenerativeModel({ model: "gemini-1.5-flash"});

        const result = await model.generateContent(fullResponse);

        const response = await result.response;
        
        const text = response.text();

        
        const responseSection = document.getElementById('response-section');

        responseSection.style.display = 'block';

        const AiResponse = document.getElementById('ai-response');

        AiResponse.textContent = text;
}

run()});
    </script>
    
</body>
{% endblock %}
